{"version":3,"file":"d3plus-common.js","sources":["../src/accessor.js","../src/isObject.js","../src/assign.js","../src/attrize.js","../src/uuid.js","../src/RESET.js","../src/BaseClass.js","../src/closest.js","../src/configPrep.js","../src/constant.js","../src/elem.js","../src/merge.js","../src/parseSides.js","../src/prefix.js","../src/stylize.js"],"sourcesContent":["/**\n    @function accessor\n    @desc Wraps an object key in a simple accessor function.\n    @param {String} key The key to be returned from each Object passed to the function.\n    @param {*} [def] A default value to be returned if the key is not present.\n    @example <caption>this</caption>\naccessor(\"id\");\n    @example <caption>returns this</caption>\nfunction(d) {\n  return d[\"id\"];\n}\n*/\nexport default function(key, def) {\n  if (def === void 0) return d => d[key];\n  return d => d[key] === void 0 ? def : d[key];\n}\n","/**\n    @function isObject\n    @desc Detects if a variable is a javascript Object.\n    @param {*} item\n*/\nexport default function(item) {\n  return item &&\n    typeof item === \"object\" &&\n    (typeof window === \"undefined\" || item !== window && item !== window.document && !(item instanceof Element)) &&\n    !Array.isArray(item)\n    ? true : false;\n}\n","import {default as isObject} from \"./isObject\";\n\n/**\n    @function validObject\n    @desc Determines if the object passed is the document or window.\n    @param {Object} obj\n    @private\n*/\nfunction validObject(obj) {\n  if (typeof window === \"undefined\") return true;\n  else return obj !== window && obj !== document;\n}\n\n/**\n    @function assign\n    @desc A deeply recursive version of `Object.assign`.\n    @param {...Object} objects\n    @example <caption>this</caption>\nassign({id: \"foo\", deep: {group: \"A\"}}, {id: \"bar\", deep: {value: 20}}));\n    @example <caption>returns this</caption>\n{id: \"bar\", deep: {group: \"A\", value: 20}}\n*/\nfunction assign(...objects) {\n\n  const target = objects[0];\n  for (let i = 1; i < objects.length; i++) {\n\n    const source = objects[i];\n\n    Object.keys(source).forEach(prop => {\n\n      const value = source[prop];\n\n      if (isObject(value) && validObject(value)) {\n        if (target.hasOwnProperty(prop) && isObject(target[prop])) target[prop] = assign({}, target[prop], value);\n        else target[prop] = assign({}, value);\n      }\n      else if (Array.isArray(value)) target[prop] = value.slice();\n      else target[prop] = value;\n\n    });\n  }\n\n  return target;\n\n}\n\nexport default assign;\n","/**\n    @function attrize\n    @desc Applies each key/value in an object as an attr.\n    @param {D3selection} elem The D3 element to apply the styles to.\n    @param {Object} attrs An object of key/value attr pairs.\n*/\nexport default function(e, a = {}) {\n  for (const k in a) if ({}.hasOwnProperty.call(a, k)) e.attr(k, a[k]);\n}\n","/**\n    @function s\n    @desc Returns 4 random characters, used for constructing unique identifiers.\n    @private\n*/\nfunction s() {\n  return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n}\n\n/**\n    @function uuid\n    @summary Returns a unique identifier.\n*/\nexport default function() {\n  return `${s()}${s()}-${s()}-${s()}-${s()}-${s()}${s()}${s()}`;\n}\n","/**\n    @constant RESET\n    @desc String constant used to reset an individual config property.\n*/\nexport default \"D3PLUS-COMMON-RESET\";\n","import assign from \"./assign\";\nimport isObject from \"./isObject\";\nimport uuid from \"./uuid\";\nimport RESET from \"./RESET\";\n\n/**\n    @desc Recursive function that resets nested Object configs.\n    @param {Object} obj\n    @param {Object} defaults\n    @private\n*/\nfunction nestedReset(obj, defaults) {\n  if (isObject(obj)) {\n    for (const nestedKey in obj) {\n      if ({}.hasOwnProperty.call(obj, nestedKey) && !nestedKey.startsWith(\"_\")) {\n        const defaultValue = defaults && isObject(defaults) ? defaults[nestedKey] : undefined;\n        if (obj[nestedKey] === RESET) {\n          obj[nestedKey] = defaultValue;\n        }\n        else if (isObject(obj[nestedKey])) {\n          nestedReset(obj[nestedKey], defaultValue);\n        }\n      }\n    }\n  }\n}\n\n/**\n    @class BaseClass\n    @summary An abstract class that contains some global methods and functionality.\n*/\nexport default class BaseClass {\n\n  /**\n      @memberof BaseClass\n      @desc Invoked when creating a new class instance, and sets any default parameters.\n      @private\n  */\n  constructor() {\n    this._on = {};\n    this._uuid = uuid();\n  }\n\n  /**\n      @memberof BaseClass\n      @desc If *value* is specified, sets the methods that correspond to the key/value pairs and returns this class. If *value* is not specified, returns the current configuration.\n      @param {Object} [*value*]\n      @chainable\n  */\n  config(_) {\n    if (!this._configDefault) {\n      const config = {};\n      for (const k in this.__proto__) {\n        if (k.indexOf(\"_\") !== 0 && ![\"config\", \"constructor\", \"render\"].includes(k)) {\n          const v = this[k]();\n          config[k] = isObject(v) ? assign({}, v) : v;\n        }\n      }\n      this._configDefault = config;\n    }\n    if (arguments.length) {\n      for (const k in _) {\n        if ({}.hasOwnProperty.call(_, k) && k in this) {\n          const v = _[k];\n          if (v === RESET) {\n            if (k === \"on\") this._on = this._configDefault[k];\n            else this[k](this._configDefault[k]);\n          }\n          else {\n            nestedReset(v, this._configDefault[k]);\n            this[k](v);\n          }\n        }\n      }\n      return this;\n    }\n    else {\n      const config = {};\n      for (const k in this.__proto__) if (k.indexOf(\"_\") !== 0 && ![\"config\", \"constructor\", \"render\"].includes(k)) config[k] = this[k]();\n      return config;\n    }\n  }\n\n  /**\n      @memberof BaseClass\n      @desc Adds or removes a *listener* to each object for the specified event *typenames*. If a *listener* is not specified, returns the currently assigned listener for the specified event *typename*. Mirrors the core [d3-selection](https://github.com/d3/d3-selection#selection_on) behavior.\n      @param {String} [*typenames*]\n      @param {Function} [*listener*]\n      @chainable\n      @example <caption>By default, listeners apply globally to all objects, however, passing a namespace with the class name gives control over specific elements:</caption>\nnew Plot\n  .on(\"click.Shape\", function(d) {\n    console.log(\"data for shape clicked:\", d);\n  })\n  .on(\"click.Legend\", function(d) {\n    console.log(\"data for legend clicked:\", d);\n  })\n  */\n  on(_, f) {\n    return arguments.length === 2 ? (this._on[_] = f, this) : arguments.length ? typeof _ === \"string\" ? this._on[_] : (this._on = Object.assign({}, this._on, _), this) : this._on;\n  }\n\n}\n","/**\n    @function closest\n    @desc Finds the closest numeric value in an array.\n    @param {Number} n The number value to use when searching the array.\n    @param {Array} arr The array of values to test against.\n*/\nexport default function(n, arr = []) {\n  if (!arr || !(arr instanceof Array) || !arr.length) return undefined;\n  return arr.reduce((prev, curr) => Math.abs(curr - n) < Math.abs(prev - n) ? curr : prev);\n}\n","/**\n    @function configPrep\n    @desc Preps a config object for d3plus data, and optionally bubbles up a specific nested type. When using this function, you must bind a d3plus class' `this` context.\n    @param {Object} [config = this._shapeConfig] The configuration object to parse.\n    @param {String} [type = \"shape\"] The event classifier to user for \"on\" events. For example, the default event type of \"shape\" will apply all events in the \"on\" config object with that key, like \"click.shape\" and \"mouseleave.shape\", in addition to any gloval events like \"click\" and \"mouseleave\".\n    @param {String} [nest] An optional nested key to bubble up to the parent config level.\n*/\nexport default function configPrep(config = this._shapeConfig, type = \"shape\", nest = false) {\n\n  const newConfig = {duration: this._duration, on: {}};\n\n  const wrapFunction = func => (d, i, s) => {\n    while (d.__d3plus__) {\n      i = d.i;\n      d = d.data || d.feature;\n    }\n    return func.bind(this)(d, i, s);\n  };\n\n  const parseEvents = (newObj, on) => {\n\n    for (const event in on) {\n\n      if ({}.hasOwnProperty.call(on, event) && !event.includes(\".\") || event.includes(`.${type}`)) {\n        newObj.on[event] = wrapFunction(on[event]);\n      }\n\n    }\n\n  };\n\n  const keyEval = (newObj, obj) => {\n\n    for (const key in obj) {\n\n      if ({}.hasOwnProperty.call(obj, key)) {\n\n        if (key === \"on\") parseEvents(newObj, obj[key]);\n        else if (typeof obj[key] === \"function\") {\n          newObj[key] = wrapFunction(obj[key]);\n        }\n        else if (typeof obj[key] === \"object\" && !(obj instanceof Array)) {\n          newObj[key] = {on: {}};\n          keyEval(newObj[key], obj[key]);\n        }\n        else newObj[key] = obj[key];\n\n      }\n\n    }\n\n  };\n\n  keyEval(newConfig, config);\n  if (this._on) parseEvents(newConfig, this._on);\n  if (nest && config[nest]) {\n    keyEval(newConfig, config[nest]);\n    if (config[nest].on) parseEvents(newConfig, config[nest].on);\n  }\n\n  return newConfig;\n\n}\n","/**\n    @function constant\n    @desc Wraps non-function variables in a simple return function.\n    @param {Array|Number|Object|String} value The value to be returned from the function.\n    @example <caption>this</caption>\nconstant(42);\n    @example <caption>returns this</caption>\nfunction() {\n  return 42;\n}\n*/\nexport default function(value) {\n  return function constant() {\n    return value;\n  };\n}\n","import {select} from \"d3-selection\";\nimport {transition} from \"d3-transition\";\n\nimport {default as attrize} from \"./attrize\";\n\n/**\n    @function elem\n    @desc Manages the enter/update/exit pattern for a single DOM element.\n    @param {String} selector A D3 selector, which must include the tagname and a class and/or ID.\n    @param {Object} params Additional parameters.\n    @param {Boolean} [params.condition = true] Whether or not the element should be rendered (or removed).\n    @param {Object} [params.enter = {}] A collection of key/value pairs that map to attributes to be given on enter.\n    @param {Object} [params.exit = {}] A collection of key/value pairs that map to attributes to be given on exit.\n    @param {D3Selection} [params.parent = d3.select(\"body\")] The parent element for this new element to be appended to.\n    @param {D3Transition} [params.transition = d3.transition().duration(0)] The transition to use when animated the different life cycle stages.\n    @param {Object} [params.update = {}] A collection of key/value pairs that map to attributes to be given on update.\n*/\nexport default function(selector, p) {\n\n  // overrides default params\n  p = Object.assign({}, {\n    condition: true,\n    enter: {},\n    exit: {},\n    parent: select(\"body\"),\n    transition: transition().duration(0),\n    update: {}\n  }, p);\n\n  const className = (/\\.([^#]+)/g).exec(selector),\n        id = (/#([^\\.]+)/g).exec(selector),\n        tag = (/^([^.^#]+)/g).exec(selector)[1];\n\n  const elem = p.parent.selectAll(selector.includes(\":\") ? selector.split(\":\")[1] : selector)\n    .data(p.condition ? [null] : []);\n\n  const enter = elem.enter().append(tag).call(attrize, p.enter);\n\n  if (id) enter.attr(\"id\", id[1]);\n  if (className) enter.attr(\"class\", className[1]);\n\n  elem.exit().transition(p.transition).call(attrize, p.exit).remove();\n\n  const update = enter.merge(elem);\n  update.transition(p.transition).call(attrize, p.update);\n\n  return update;\n\n}\n","import {merge, sum} from \"d3-array\";\nimport {keys} from \"d3-collection\";\n\n/**\n    @function merge\n    @desc Combines an Array of Objects together and returns a new Object.\n    @param {Array} objects The Array of objects to be merged together.\n    @param {Object} aggs An object containing specific aggregation methods (functions) for each key type. By default, numbers are summed and strings are returned as an array of unique values.\n    @example <caption>this</caption>\nmerge([\n  {id: \"foo\", group: \"A\", value: 10, links: [1, 2]},\n  {id: \"bar\", group: \"A\", value: 20, links: [1, 3]}\n]);\n    @example <caption>returns this</caption>\n{id: [\"bar\", \"foo\"], group: \"A\", value: 30, links: [1, 2, 3]}\n*/\nfunction objectMerge(objects, aggs = {}) {\n\n  const availableKeys = new Set(merge(objects.map(o => keys(o)))),\n        newObject = {};\n\n  availableKeys.forEach(k => {\n    const values = objects.map(o => o[k]);\n    let value;\n    if (aggs[k]) value = aggs[k](values);\n    else {\n      const types = values.map(v => v || v === false ? v.constructor : v).filter(v => v !== void 0);\n      if (!types.length) value = undefined;\n      else if (types.indexOf(Array) >= 0) {\n        value = merge(values.map(v => v instanceof Array ? v : [v]));\n        value = Array.from(new Set(value));\n        if (value.length === 1) value = value[0];\n      }\n      else if (types.indexOf(String) >= 0) {\n        value = Array.from(new Set(values));\n        if (value.length === 1) value = value[0];\n      }\n      else if (types.indexOf(Number) >= 0) value = sum(values);\n      else if (types.indexOf(Object) >= 0) value = objectMerge(values.filter(v => v));\n      else {\n        value = Array.from(new Set(values.filter(v => v !== void 0)));\n        if (value.length === 1) value = value[0];\n      }\n    }\n    newObject[k] = value;\n  });\n\n  return newObject;\n\n}\n\nexport default objectMerge;\n","/**\n @function parseSides\n @desc Converts a string of directional CSS shorthand values into an object with the values expanded.\n @param {String|Number} sides The CSS shorthand string to expand.\n */\nexport default function(sides) {\n  let values;\n  if (typeof sides === \"number\") values = [sides];\n  else values = sides.split(/\\s+/);\n\n  if (values.length === 1) values = [values[0], values[0], values[0], values[0]];\n  else if (values.length === 2) values = values.concat(values);\n  else if (values.length === 3) values.push(values[1]);\n\n  return [\n    \"top\",\n    \"right\",\n    \"bottom\",\n    \"left\"\n  ].reduce((acc, direction, i) => {\n    const value = parseFloat(values[i]);\n    acc[direction] = value || 0;\n    return acc;\n  }, {});\n}\n","/**\n    @function prefix\n    @desc Returns the appropriate CSS vendor prefix, given the current browser.\n*/\nexport default function() {\n  if (\"-webkit-transform\" in document.body.style) return \"-webkit-\";\n  else if (\"-moz-transform\" in document.body.style) return \"-moz-\";\n  else if (\"-ms-transform\" in document.body.style) return \"-ms-\";\n  else if (\"-o-transform\" in document.body.style) return \"-o-\";\n  else return \"\";\n}\n","/**\n    @function stylize\n    @desc Applies each key/value in an object as a style.\n    @param {D3selection} elem The D3 element to apply the styles to.\n    @param {Object} styles An object of key/value style pairs.\n*/\nexport default function(e, s = {}) {\n  for (const k in s) if ({}.hasOwnProperty.call(s, k)) e.style(k, s[k]);\n}\n"],"names":["const","let","i","k","v","config","this","select","transition","merge","keys","sum"],"mappings":"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"}