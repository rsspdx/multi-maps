{"version":3,"file":"_drawColorScale.js","sources":["../../src/_drawColorScale.js"],"sourcesContent":["import {min} from \"d3-array\";\nimport {elem} from \"d3plus-common\";\n\n/**\n    @function _drawColorScale\n    @desc Renders the color scale if this._colorScale is not falsey.\n    @private\n*/\nexport default function() {\n\n  const data = this._data;\n\n  const position = this._colorScalePosition || \"bottom\";\n  const wide = [\"top\", \"bottom\"].includes(position);\n\n  const availableWidth = this._width - (this._margin.left + this._margin.right + this._padding.left + this._padding.right);\n\n  const width = wide\n    ? min([this._colorScaleMaxSize, availableWidth])\n    : this._width - (this._margin.left + this._margin.right);\n\n  const availableHeight = this._height - (this._margin.bottom + this._margin.top + this._padding.bottom + this._padding.top);\n\n  const height = !wide\n    ? min([this._colorScaleMaxSize, availableHeight])\n    : this._height - (this._margin.bottom + this._margin.top);\n\n  const transform = {\n    opacity: this._colorScalePosition ? 1 : 0,\n    transform: `translate(${wide ? this._margin.left + this._padding.left + (availableWidth - width) / 2 : this._margin.left}, ${wide ? this._margin.top : this._margin.top + this._padding.top + (availableHeight - height) / 2})`\n  };\n\n  const showColorScale = this._colorScale && data && data.length > 1;\n\n  const scaleGroup = elem(\"g.d3plus-viz-colorScale\", {\n    condition: showColorScale && !this._colorScaleConfig.select,\n    enter: transform,\n    parent: this._select,\n    transition: this._transition,\n    update: transform\n  }).node();\n\n  if (showColorScale) {\n    const scaleData = data.filter((d, i) => {\n      const c = this._colorScale(d, i);\n      return c !== undefined && c !== null;\n    });\n\n    this._colorScaleClass\n      .align({bottom: \"end\", left: \"start\", right: \"end\", top: \"start\"}[position] || \"bottom\")\n      .duration(this._duration)\n      .data(scaleData)\n      .height(height)\n      .orient(position)\n      .select(scaleGroup)\n      .value(this._colorScale)\n      .width(width)\n      .config(this._colorScaleConfig)\n      .render();\n\n    const scaleBounds = this._colorScaleClass.outerBounds();\n    if (this._colorScalePosition && !this._colorScaleConfig.select && scaleBounds.height) {\n      if (wide) this._margin[position] += scaleBounds.height + this._legendClass.padding() * 2;\n      else this._margin[position] += scaleBounds.width + this._legendClass.padding() * 2;\n    }\n\n  }\n  else {\n    this._colorScaleClass.config(this._colorScaleConfig);\n  }\n\n\n\n}\n"],"names":["const","this"],"mappings":"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"}